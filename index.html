<!DOCTYPE html>
<html lang="zh-TW">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
   <title>HalleLuluÂ·Nail</title>
   <style>
       :root {
           --bg-color: #fcfaf2;
           --primary-brown: #a68b7c;
           --accent-cream: #f4eee8;
           --text-main: #5d544f;
           --white: #ffffff;
           --shadow: 0 4px 12px rgba(166, 139, 124, 0.15);
       }

       * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
       body {
           font-family: -apple-system, "Noto Sans TC", sans-serif;
           background-color: var(--bg-color);
           color: var(--text-main);
           margin: 0; padding: 20px 0 100px 0;
           line-height: 1.6;
       }

       .container { width: 92%; max-width: 500px; margin: 0 auto; }
       h1 { text-align: center; font-weight: 300; letter-spacing: 2px; color: var(--primary-brown); margin-bottom: 25px; }

       /* å¡ç‰‡æ¨£å¼ */
       .card {
           background: var(--white);
           border-radius: 20px;
           padding: 20px;
           margin-bottom: 20px;
           box-shadow: var(--shadow);
       }

       .section-title { font-size: 1rem; font-weight: bold; margin-bottom: 15px; border-left: 4px solid var(--primary-brown); padding-left: 10px; }

       select, input {
           width: 100%;
           padding: 12px;
           border: 1px solid var(--accent-cream);
           border-radius: 10px;
           font-size: 16px; /* é˜²æ­¢ iOS ç¸®æ”¾ */
           background: var(--bg-color);
           color: var(--text-main);
       }

       /* æ©«å‘æ»¾å‹•å·¥å…·åˆ— */
       .toolbar-wrapper { overflow-x: auto; white-space: nowrap; margin-bottom: 15px; padding-bottom: 5px; -webkit-overflow-scrolling: touch; }
       .tool-btn {
           display: inline-block;
           padding: 8px 18px;
           background: var(--accent-cream);
           border-radius: 50px;
           margin-right: 8px;
           font-size: 14px;
           cursor: pointer;
           border: 1px solid transparent;
           transition: 0.3s;
       }
       .tool-btn:active { background: var(--primary-brown); color: white; }

       /* å‹•æ…‹é€ å‹åˆ— */
       .item-row {
           display: grid;
           grid-template-columns: 2fr 1fr 1fr auto;
           gap: 8px;
           align-items: center;
           margin-bottom: 10px;
           background: #faf9f7;
           padding: 10px;
           border-radius: 12px;
       }
       .qty-control { display: flex; align-items: center; justify-content: space-between; background: white; border-radius: 8px; border: 1px solid #eee; }
       .qty-btn { width: 30px; text-align: center; cursor: pointer; font-weight: bold; font-size: 18px; color: var(--primary-brown); }
       .remove-btn { color: #cc8b8b; font-size: 20px; padding: 0 5px; cursor: pointer; }

       /* å¸ç”²æŒ‰éˆ•çµ„ */
       .btn-group { display: flex; gap: 5px; }
       .btn-group button {
           flex: 1; padding: 10px; border: 1px solid var(--accent-cream);
           background: white; border-radius: 8px; font-size: 14px; cursor: pointer;
       }
       .btn-group button.active { background: var(--primary-brown); color: white; border-color: var(--primary-brown); }

       /* åº•éƒ¨æ‡¸æµ®æ¬„ */
       .sticky-footer {
           position: fixed; bottom: 0; width: 100%; background: var(--white);
           padding: 15px 20px; box-shadow: 0 -4px 15px rgba(0,0,0,0.05);
           display: flex; justify-content: space-between; align-items: center; z-index: 100;
       }
       .total-price { font-size: 1.4rem; font-weight: bold; color: var(--primary-brown); }
       .footer-btns { display: flex; gap: 10px; }
       .main-btn { background: var(--primary-brown); color: white; border: none; padding: 10px 15px; border-radius: 10px; font-size: 14px; }

       /* Modal Bottom Sheet */
       .modal-overlay {
           position: fixed; top: 0; left: 0; width: 100%; height: 100%;
           background: rgba(0,0,0,0.4); display: none; z-index: 200;
       }
       .modal-content {
           position: fixed; bottom: 0; width: 100%; background: white;
           border-radius: 25px 25px 0 0; padding: 30px 20px;
           transform: translateY(100%); transition: transform 0.3s ease;
       }
       .modal-content.show { transform: translateY(0); }
       .bill-item { display: flex; justify-content: space-between; margin-bottom: 10px; border-bottom: 1px dashed #eee; padding-bottom: 5px; }

       /* å¾Œå°è¨­å®š */
       .admin-section { margin-top: 40px; border-top: 1px solid #ddd; padding-top: 20px; opacity: 0.6; }
       details summary { cursor: pointer; color: var(--primary-brown); margin-bottom: 10px; }
   </style>
   <link rel="apple-touch-icon" href="icon.jpg">
<meta name="apple-mobile-web-app-title" content="HalleLuluÂ·Nail">
<meta name="apple-mobile-web-app-capable" content="yes">
</head>
<body>

<div class="container">
   <h1>Halle Lulu Nail</h1>

   <div class="card">
       <div class="section-title">åŸºç¤åº•è‰² / ä¿é¤Š</div>
       <select id="baseService" onchange="calculate()">
           <option value="0" data-name="ç„¡">è«‹é¸æ“‡æœå‹™é …ç›®</option>
           <optgroup label="å‡è† æŒ‡ç”² (æ‰‹éƒ¨)">
               <option value="500" data-name="æ‰‹éƒ¨-é€æ˜å»ºç”²">æ‰‹éƒ¨-é€æ˜å»ºç”² $500</option>
               <option value="600" data-name="æ‰‹éƒ¨-å–®è‰²/è·³è‰²">æ‰‹éƒ¨-å–®è‰²/è·³è‰² $600</option>
               <option value="700" data-name="æ‰‹éƒ¨-è²“çœ¼/é¡é¢">æ‰‹éƒ¨-è²“çœ¼/é¡é¢ $700</option>
               <option value="800" data-name="æ‰‹éƒ¨-æ¼¸å±¤/æ³•å¼">æ‰‹éƒ¨-æ¼¸å±¤/æ³•å¼ $800</option>
               <option value="850" data-name="æ‰‹éƒ¨-é€ å‹æ¬¾å¼">æ‰‹éƒ¨-é€ å‹æ¬¾å¼ $850èµ·</option>
           </optgroup>
           <optgroup label="å‡è† æŒ‡ç”² (è¶³éƒ¨)">
               <option value="600" data-name="è¶³éƒ¨-é€æ˜å»ºç”²">è¶³éƒ¨-é€æ˜å»ºç”² $600</option>
               <option value="700" data-name="è¶³éƒ¨-å–®è‰²/è·³è‰²">è¶³éƒ¨-å–®è‰²/è·³è‰² $700</option>
               <option value="800" data-name="è¶³éƒ¨-è²“çœ¼/é¡é¢">è¶³éƒ¨-è²“çœ¼/é¡é¢ $800</option>
               <option value="900" data-name="è¶³éƒ¨-æ¼¸å±¤/æ³•å¼">è¶³éƒ¨-æ¼¸å±¤/æ³•å¼ $900</option>
               <option value="950" data-name="è¶³éƒ¨-é€ å‹æ¬¾å¼">è¶³éƒ¨-é€ å‹æ¬¾å¼ $950èµ·</option>
           </optgroup>
           <optgroup label="ä¿é¤Š">
               <option value="300" data-name="æ‰‹éƒ¨-å¾®è­·ç†">æ‰‹éƒ¨-å¾®è­·ç† $300</option>
               <option value="500" data-name="æ‰‹éƒ¨-åŸºç¤ä¿é¤Š">æ‰‹éƒ¨-åŸºç¤ä¿é¤Š $500</option>
               <option value="400" data-name="è¶³éƒ¨-å¾®è­·ç†">è¶³éƒ¨-å¾®è­·ç† $400</option>
               <option value="600" data-name="è¶³éƒ¨-åŸºç¤ä¿é¤Š">è¶³éƒ¨-åŸºç¤ä¿é¤Š $600</option>
           </optgroup>
       </select>
   </div>

   <div class="card">
       <div class="section-title">é€ å‹åŠ è³¼</div>
       <div class="toolbar-wrapper">
           <div class="tool-btn" onclick="addItem('æ‰‹ç¹ªç°¡æ˜“', 25)">æ‰‹ç¹ª(ç°¡) $25</div>
           <div class="tool-btn" onclick="addItem('æ‰‹ç¹ªå¡é€š', 150)">æ‰‹ç¹ª(å¡) $150</div>
           <div class="tool-btn" onclick="addItem('æ»¿é‘½(å–®æŒ‡)', 150)">æ»¿é‘½ $150</div>
           <div class="tool-btn" onclick="addItem('è²¼ç´™(ç²¾ç·»)', 50)">è²¼ç´™ $50</div>
           <div class="tool-btn" onclick="addItem('å¤šå±¤æ¬¡æšˆæŸ“', 80)">æšˆæŸ“ $80</div>
           <div class="tool-btn" onclick="addItem('é€ å‹åˆ·æŸ“', 50)">åˆ·æŸ“ $50</div>
           <div class="tool-btn" onclick="addItem('å»¶ç”²', 100)">å»¶ç”² $100</div>
       </div>

       <div id="dynamicItems">
           </div>
   </div>

   <div class="card">
       <div class="section-title">å¸ç”²æœå‹™</div>
       <div class="btn-group" id="removalType">
           <button class="active" onclick="setRemoval(0, this)">ç„¡</button>
           <button onclick="setRemoval(100, this)">æœ¬åº—çºŒåš $100</button>
           <button onclick="setRemoval(200, this)">ä»–åº—çºŒåš $200</button>
       </div>
       <div style="margin-top:15px; display:flex; justify-content: space-between; align-items: center;">
           <span style="font-size:14px">ç«‹é«”é£¾å“/å¤§é‘½å¸é™¤ (+$50/æŒ‡)</span>
           <div class="qty-control" style="width:100px;">
               <div class="qty-btn" onclick="updateExtraRemoval(-1)">-</div>
               <div id="extraRemovalQty">0</div>
               <div class="qty-btn" onclick="updateExtraRemoval(1)">+</div>
           </div>
       </div>
   </div>

   <div class="card">
       <div class="section-title">æŠ˜æ‰£ / é¡å¤–åŠ åƒ¹</div>
       <input type="number" id="adjustment" placeholder="ä¾‹å¦‚: -100 æˆ– 50" oninput="calculate()">
   </div>

   <div class="container admin-section">
       <details>
           <summary>âš™ï¸ å¾Œå°å®šåƒ¹å¿«é€Ÿè¨­å®š</summary>
           <div class="card" style="font-size: 12px;">
               <p>æ­¤è™•å¯ä¾›æœªä¾†æ“´å……åŠŸèƒ½ä½¿ç”¨ï¼ˆç›®å‰ç›´æ¥æŠ“å–ä¸Šæ–¹é™£åˆ—ï¼‰</p>
               <button onclick="alert('è¨­å®šå·²å„²å­˜ (ç¯„ä¾‹)')" class="main-btn">å„²å­˜ä¿®æ”¹</button>
           </div>
       </details>
   </div>
</div>

<div class="sticky-footer">
   <div>
       <div style="font-size: 12px; color: #888;">é è¨ˆç¸½é‡‘é¡</div>
       <div class="total-price" id="displayTotal">$0</div>
   </div>
   <div class="footer-btns">
       <button class="main-btn" style="background:#f4eee8; color:#a68b7c" onclick="toggleModal(true)">ğŸ‘ï¸ æ˜ç´°</button>
       <button class="main-btn" onclick="copyBill()">ğŸ“‹ è¤‡è£½</button>
   </div>
</div>

<div class="modal-overlay" id="overlay" onclick="toggleModal(false)">
   <div class="modal-content" id="modalContent" onclick="event.stopPropagation()">
       <h3 style="text-align:center; margin-top:0;">Halle Lulu Nail æœå‹™æ˜ç´°</h3>
       <div id="billDetails"></div>
       <hr style="border:none; border-top:1px dashed #ddd; margin: 15px 0;">
       <div style="display:flex; justify-content:space-between; font-weight:bold; font-size:1.2rem;">
           <span>ç¸½è¨ˆ</span>
           <span id="modalTotal">$0</span>
       </div>
       <button class="main-btn" style="width:100%; margin-top:20px; padding:15px;" onclick="toggleModal(false)">é—œé–‰</button>
   </div>
</div>

<script>
   let removalFee = 0;
   let extraRemovalCount = 0;

   // é»æ“Šè¼¸å…¥æ¡†è‡ªå‹•å…¨é¸ä¸¦æ»¾å‹•
   function setupInputOptimization(el) {
       el.addEventListener('focus', function() {
           setTimeout(() => {
               this.select();
               this.scrollIntoView({ behavior: 'smooth', block: 'center' });
           }, 100);
       });
   }

   function addItem(name = '', price = 0) {
       const container = document.getElementById('dynamicItems');
       const row = document.createElement('div');
       row.className = 'item-row';
       row.innerHTML = `
           <input type="text" placeholder="é …ç›®" value="${name}" oninput="calculate()">
           <input type="number" placeholder="å–®åƒ¹" value="${price}" oninput="calculate()">
           <div class="qty-control">
               <div class="qty-btn" onclick="changeQty(this, -1)">-</div>
               <div class="qty-num">1</div>
               <div class="qty-btn" onclick="changeQty(this, 1)">+</div>
           </div>
           <div class="remove-btn" onclick="this.parentElement.remove(); calculate();">âœ•</div>
       `;
       container.appendChild(row);

       // ç¶å®šè¼¸å…¥å„ªåŒ–
       const inputs = row.querySelectorAll('input');
       inputs.forEach(setupInputOptimization);

       calculate();
   }

   function changeQty(btn, delta) {
       const numEl = btn.parentElement.querySelector('.qty-num');
       let val = parseInt(numEl.innerText) + delta;
       if (val < 1) val = 1;
       numEl.innerText = val;
       calculate();
   }

   function setRemoval(fee, btn) {
       removalFee = fee;
       const btns = document.querySelectorAll('#removalType button');
       btns.forEach(b => b.classList.remove('active'));
       btn.classList.add('active');
       calculate();
   }

   function updateExtraRemoval(delta) {
       extraRemovalCount += delta;
       if (extraRemovalCount < 0) extraRemovalCount = 0;
       document.getElementById('extraRemovalQty').innerText = extraRemovalCount;
       calculate();
   }

   function calculate() {
       let total = 0;

       // 1. åŸºç¤
       const base = document.getElementById('baseService');
       total += parseInt(base.value);

       // 2. å‹•æ…‹é€ å‹
       const rows = document.querySelectorAll('.item-row');
       rows.forEach(row => {
           const p = parseInt(row.querySelectorAll('input')[1].value) || 0;
           const q = parseInt(row.querySelector('.qty-num').innerText) || 0;
           total += (p * q);
       });

       // 3. å¸ç”²
       total += removalFee;
       total += (extraRemovalCount * 50);

       // 4. å…¶ä»–èª¿æ•´
       const adj = parseInt(document.getElementById('adjustment').value) || 0;
       total += adj;

       document.getElementById('displayTotal').innerText = `$${total}`;
       return total;
   }

   function getBillText() {
       let bill = `ã€Halle Lulu Nail æ˜ç´°ã€‘\n`;
       const base = document.getElementById('baseService');
       if (base.value != 0) {
           bill += `â€¢ ${base.options[base.selectedIndex].dataset.name}: $${base.value}\n`;
       }

       const rows = document.querySelectorAll('.item-row');
       rows.forEach(row => {
           const n = row.querySelectorAll('input')[0].value || 'è‡ªè¨‚é …ç›®';
           const p = row.querySelectorAll('input')[1].value || 0;
           const q = row.querySelector('.qty-num').innerText;
           bill += `â€¢ ${n} x${q}: $${p * q}\n`;
       });

       if (removalFee > 0) bill += `â€¢ çºŒåšå¸ç”²: $${removalFee}\n`;
       if (extraRemovalCount > 0) bill += `â€¢ å¤§é‘½é£¾å¸é™¤ x${extraRemovalCount}: $${extraRemovalCount * 50}\n`;

       const adj = parseInt(document.getElementById('adjustment').value) || 0;
       if (adj !== 0) bill += `â€¢ èª¿æ•´/æŠ˜æ‰£: $${adj}\n`;

       bill += `------------------\nç¸½è¨ˆ: ${document.getElementById('displayTotal').innerText}`;
       return bill;
   }

   function toggleModal(show) {
       const overlay = document.getElementById('overlay');
       const content = document.getElementById('modalContent');
       const detailDiv = document.getElementById('billDetails');

       if (show) {
           const text = getBillText().replace(/\n/g, '<br>').replace(/â€¢/g, 'âœ¨');
           detailDiv.innerHTML = `<div style="line-height:2; font-size:15px;">${text}</div>`;
           document.getElementById('modalTotal').innerText = document.getElementById('displayTotal').innerText;
           overlay.style.display = 'block';
           setTimeout(() => content.classList.add('show'), 10);
       } else {
           content.classList.remove('show');
           setTimeout(() => overlay.style.display = 'none', 300);
       }
   }

   function copyBill() {
       const text = getBillText();
       navigator.clipboard.writeText(text).then(() => {
           alert('æ˜ç´°å·²è¤‡è£½ï¼Œå¯ç›´æ¥å‚³é€çµ¦å®¢äººï¼');
       });
   }

   // åˆå§‹åŒ–è‡ªå‹•å„ªåŒ–
   setupInputOptimization(document.getElementById('adjustment'));
</script>

</body>

</html>

